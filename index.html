<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weera's Portfolio</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=K2D:wght@300;400;600;700;900&display=swap" rel="stylesheet">
</head>

<body>
    <div class="bg-overlay" aria-hidden="true"></div>
    <div class="grain-overlay" aria-hidden="true"></div>

    <div class="content-root">
    <header class="header">
        <div class="logo-profile">
            <img src="my-profile2.jpg" alt="Weera Profile Logo" class="logo-image">
        </div>
        
        <i class="fas fa-bars" id="menu-icon"></i> 
        <nav class="navbar" id="mobile-nav">
            <a href="#hero" class="active" id="home-link">Home</a>
            <a href="#web-app-showcase" id="web-app-link">Web App</a>
            <a href="#about-me" id="about-link">Profile</a> 
            <a href="#projects-section">Expertise</a>
            <a href="#contact-section">Contact</a>
        </nav>
        <button class="cv-button-nav" id="cv-request-nav">Download CV <i class="fa-solid fa-download"></i></button>
    </header>

    <section class="hero-section" id="hero"> 
        <div class="hero-content" id="content"> 
            <span class="tag">Hello! welcome to...</span>
            <h1 class="title">My Portfolio <span class="designer-text">I'm Weera Boonkla </span></h1>
            
            <p class="description"><span id="typewriter-target"></span><span class="typewriter-caret" aria-hidden="true"></span></p>

            <div class="cta-buttons">
                <button class="btn-hire" id="contact-me-cta">Contact Me</button>
                <button class="btn-download" id="cv-request-hero">Download CV <i class="fa-solid fa-download"></i></button>
            </div>

            <div class="stats-block">
                <div class="stat-item">
                    <span class="stat-number" id="cv-download-count">...</span> 
                    <span class="stat-label">CV Requests</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">150+</span>
                    <span class="stat-label">Unique Visitors</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">7+</span>
                    <span class="stat-label">Years Experience</span>
                </div>
            </div>
            <div class="share-links">
                <span class="share-label"><i class="fa-solid fa-share-alt"></i> Share this Portfolio:</span>
                <a href="#" id="share-linkedin" class="share-btn linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                <a href="#" id="share-facebook" class="share-btn facebook" title="Share on Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="#" id="share-twitter" class="share-btn twitter" title="Share on X (Twitter)"><i class="fab fa-twitter"></i></a>
                <a href="#" id="share-line" class="share-btn line" title="Share on LINE"><i class="fab fa-line"></i></a>
            </div>

            <div class="social-links">
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="https://linkedin.com/in/weera-boonkla-a5279a118" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://www.facebook.com/weera.boonkla.2024" target="_blank"><i class="fab fa-facebook-f"></i></a>
            </div>
        </div>

        <div class="hero-image-container" id="image-container">
            <img src="my-profile.jpg" alt="Weera Boonkla Professional Profile" class="profile-image" id="profile-img"> 
        </div>
    </section>
    
    <section class="web-app-showcase" id="web-app-showcase">
        <div class="web-app-content content-padding">
            <h2><i class="fa-solid fa-code"></i> My Coding & Knowledge Sharing Apps</h2>
            <p class="summary-text">
                นอกเหนือจากงานด้านวิศวกรรมไฟฟ้า ผมยังพัฒนา Web Application ง่ายๆ เพื่อแบ่งปันความรู้ด้าน Coding และเครื่องมือที่เป็นประโยชน์ในชีวิตประจำวัน 
            </p>
            
            <div class="app-card-grid">
                
                <div class="app-card">
                    <i class="fa-brands fa-google"></i>
                    <h3>Google Apps Script Automation</h3>
                    <p>ตัวอย่างการใช้ Apps Script เพื่อสร้างระบบอัตโนมัติในการจัดการข้อมูล, การส่งอีเมลแจ้งเตือน หรือสร้าง API สำหรับเชื่อมต่อกับ Google Sheet</p>
                    <a href="https://github.com/WeeraBoonkla/AppsScript-Examples" target="_blank" class="app-link-btn">
                        <i class="fa-brands fa-github"></i> ดู Source Code
                    </a>
                </div>

                <div class="app-card">
                    <i class="fa-solid fa-calculator"></i>
                    <h3>Electrical Calculator Tool</h3>
                    <p>เครื่องมือคำนวณพื้นฐานทางไฟฟ้า (เช่น Current, Voltage Drop, Power Factor) ที่สร้างด้วย HTML, CSS และ JavaScript</p>
                    <a href="#" class="app-link-btn disabled-link">
                        <i class="fa-solid fa-external-link-alt"></i> ดู Live Demo (เร็วๆ นี้)
                    </a>
                </div>

                <div class="app-card">
                    <i class="fa-solid fa-book-open"></i>
                    <h3>Technical Blog Snippets</h3>
                    <p>รวบรวมโค้ดและวิธีการแก้ปัญหาเฉพาะทางที่เกี่ยวข้องกับการทำ Web Front-end/JavaScript</p>
                    <a href="#" class="app-link-btn disabled-link">
                        <i class="fa-solid fa-link"></i> เยี่ยมชม Blog (เร็วๆ นี้)
                    </a>
                </div>
                
            </div>
        </div>
    </section>
    
    <section class="about-section" id="about-me">
        <div class="about-content content-padding">
            <h2>Professional Profile</h2>
            <div class="about-grid">
                <div class="about-text">
                    <p>
                        Weera Boonkla is a highly experienced and dedicated **Electrical Project Engineer** with over 7 years of specialized expertise in the complete lifecycle management of electrical power projects.
                    </p>
                    <p>
                        My core competency spans from initial design, rigorous procurement, and effective material/subcontractor management, all the way to final testing and commissioning. I ensure project success by expertly managing costs, adhering to tight schedules, and maintaining high engineering standards for both Low Voltage (LV) and Medium Voltage (MV) power systems.
                    </p>
                </div>
                <div class="info-block">
                    <h3><i class="fa-solid fa-graduation-cap"></i> Education & Languages</h3>
                    <p>**Bachelor of Engineering in Electrical Engineering** from Ubon Ratchathani University.</p>
                    <p>Fluent in **Thai**. Technical and business proficiency in **English**.</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="projects-section" id="projects-section">
        <div class="projects-content content-padding">
            <h2>Core Experience & Expertise</h2>
            <p class="summary-text">Summary of key responsibilities and specialization areas across 7+ years of project execution and electrical design.</p>
            
            <div class="expertise-list">
                <div class="role-block">
                    <h3><i class="fa-solid fa-bolt"></i> Current Role: Project Engineer (Schneider Electric, 2018–Present)</h3>
                    <ul>
                        <li>**Full Project Lifecycle Management:** Successfully executes multiple electrical projects, ensuring strict cost control, schedule adherence, and engineering quality from start to finish.</li>
                        <li>**Technical Product Specialization:** Deep expertise in the application and implementation of **Schneider Electric's LV and MV** electrical power products.</li>
                        <li>**Execution & Commissioning:** Manages material delivery, installation logistics, and final testing/commissioning phases.</li>
                    </ul>
                </div>
                <div class="role-block">
                    <h3><i class="fa-solid fa-industry"></i> Previous Roles: Design & Coordination (2012–2018)</h3>
                    <ul>
                        <li>**Power Plant Projects (RMS Quality):** Coordinated engineering projects, managed electrical bulk design and material supply.</li>
                        <li>**Oil & Gas Design (THAI ROTARY ENGINEERING):** Specialized in electrical power system design for the oil and gas field, focusing on high-reliability systems.</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>
    
    <section class="contact-section" id="contact-section">
        <div class="contact-content content-padding">
            <h2>Let's Connect</h2>
            <p class="summary-text">I am currently based in Bueng Kum district, Bangkok City, Thailand. I welcome opportunities for new projects, consulting roles, or collaborative ventures.</p>
            <div class="contact-info-grid">
                <p><i class="fa-solid fa-envelope"></i> Email: <a href="mailto:weera.boonkla@gmail.com">weera.boonkla@gmail.com</a></p>
                <p><i class="fa-solid fa-phone"></i> Phone: +66-96-169-8799</p>
                <p><i class="fa-brands fa-linkedin"></i> LinkedIn: <a href="https://linkedin.com/in/weera-boonkla-a5279a118" target="_blank">View Profile</a></p>
                <p><i class="fa-brands fa-facebook-f"></i> Facebook: <a href="https://www.facebook.com/weera.boonkla.2024" target="_blank">Connect on Facebook</a></p>
            </div>
        </div>
    </section>

    <div id="cv-request-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Request CV Access</h3>
            <p>Please provide your professional email to receive a download link for my CV. I will review and grant access shortly.</p>
            <form id="cv-request-form">
                <div class="form-group">
                    <label for="request-email"><i class="fa-solid fa-envelope"></i> Professional Email:</label>
                    <input type="email" id="request-email" name="email" required placeholder="e.g., your.name@company.com">
                </div>
                <div class="form-group">
                    <label for="request-wording"><i class="fa-solid fa-file-alt"></i> Purpose/Message (Optional):</label>
                    <textarea id="request-wording" name="wording" rows="3" placeholder="I am contacting you about an open Project Manager role..."></textarea>
                </div>
                <button type="submit" id="submit-request-btn" class="btn-hire">
                    <i class="fa-solid fa-paper-plane"></i> Submit Request
                </button>
                <div class="message-area" id="modal-message"></div>
            </form>
        </div>
    </div>

<script>
    // ******************************************************************************
    // *** URL ของ Google Apps Script ***
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzq5ab1FYhMb0DdBHEy4N8FbcWHWKXn74orVyC57_jEjhfElaZiw3ktmy6JAwsAJkFYmQ/exec"; 
    // ******************************************************************************


    // ------------------------------------
    // 1. IMAGE SWAPPING LOGIC (6 วินาที + Smooth Fade)
    // ------------------------------------
    const images = ['my-profile.jpg', 'my-profile2.jpg']; 
    let currentImageIndex = 0;
    const profileImg = document.getElementById('profile-img');

    function swapImage() {
        currentImageIndex = (currentImageIndex + 1) % images.length;
        const nextImageSrc = images[currentImageIndex];
        
        // Fade Out (0.5s transition is set in CSS)
        profileImg.style.opacity = '0'; 

        setTimeout(() => {
            profileImg.src = nextImageSrc;
            // Fade In
            profileImg.style.opacity = '1'; 
        }, 500); // Wait for fade out to complete
    }

    // Set interval only if profileImg element exists
    if (profileImg) {
        setInterval(swapImage, 6000); // Swap every 6 seconds
    }
    
    // ------------------------------------
    // 2. SCROLLSPY & SMOOTH SCROLL LOGIC
    // ------------------------------------
    const navLinks = document.querySelectorAll('.navbar a');
    const sections = document.querySelectorAll('section'); 

    function updateActiveLink() {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 150; 
            if (scrollY >= sectionTop) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(a => {
            a.classList.remove('active');
            if (a.getAttribute('href').includes(current)) {
                a.classList.add('active');
            }
        });
    }
    
    window.addEventListener('scroll', updateActiveLink);
    window.addEventListener('load', updateActiveLink); 
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            
            if (targetElement) {
                targetElement.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });

    // ------------------------------------
    // 3. MOBILE MENU TOGGLE LOGIC
    // ------------------------------------
    const menuIcon = document.getElementById('menu-icon');
    const mobileNav = document.getElementById('mobile-nav'); 

    if (menuIcon && mobileNav) {
        menuIcon.addEventListener('click', () => {
            mobileNav.classList.toggle('active');
            menuIcon.classList.toggle('fa-bars');
            menuIcon.classList.toggle('fa-times');
            
            document.body.style.overflow = mobileNav.classList.contains('active') ? 'hidden' : 'auto';
        });

        mobileNav.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                mobileNav.classList.remove('active');
                menuIcon.classList.remove('fa-times');
                menuIcon.classList.add('fa-bars');
                document.body.style.overflow = 'auto'; 
            });
        });
    }
    
    // ------------------------------------
    // 4. CV COUNT FETCH LOGIC
    // ------------------------------------
    function fetchCvRequestCount() {
        const countElement = document.getElementById('cv-download-count');
        if (!countElement) return;

        countElement.textContent = '...'; 
        
        const countUrl = `${APPS_SCRIPT_URL}?action=count`; 

        fetch(countUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                if (data && data.count !== undefined) {
                    countElement.textContent = data.count; 
                } else {
                    countElement.textContent = '40+'; // Fallback
                }
            })
            .catch(error => {
                console.error("Error fetching CV count:", error);
                countElement.textContent = '40+'; // Fallback 
            });
    }

    // ------------------------------------
    // 5. SHARE URL LOGIC
    // ------------------------------------
    function setupShareButtons() {
        const portfolioUrl = encodeURIComponent("https://github.com/weeraboonkla/portfolio"); 
        const shareText = encodeURIComponent("Check out Weera Boonkla's professional portfolio specializing in Electrical Project Engineering and Schneider Electric systems.");

        const shareData = [
            { id: 'share-linkedin', url: `https://www.linkedin.com/sharing/share-offsite/?url=${portfolioUrl}` },
            { id: 'share-facebook', url: `https://www.facebook.com/sharer/sharer.php?u=${portfolioUrl}` },
            { id: 'share-twitter', url: `https://twitter.com/intent/tweet?url=${portfolioUrl}&text=${shareText}` },
            { id: 'share-line', url: `https://social-plugins.line.me/lineit/share?url=${portfolioUrl}&text=${shareText}` }
        ];

        shareData.forEach(({ id, url }) => {
            const button = document.getElementById(id);
            if (button) {
                button.href = url;
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.open(url, 'ShareWindow', 'width=600,height=400,scrollbars=yes');
                });
            }
        });
    }


    // ------------------------------------
    // 6. CTA & MODAL LOGIC
    // ------------------------------------
    
    // Contact Me Button Scroll
    const contactMeCta = document.getElementById('contact-me-cta');
    contactMeCta.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector('#contact-section').scrollIntoView({
            behavior: 'smooth'
        });
    });

    // Download CV Access Request (Modal Logic)
    const cvRequestButtons = document.querySelectorAll('#cv-request-nav, #cv-request-hero');
    const modal = document.getElementById('cv-request-modal');
    const closeButton = modal.querySelector('.close-button');
    const form = document.getElementById('cv-request-form');
    const submitBtn = document.getElementById('submit-request-btn');
    const modalMessage = document.getElementById('modal-message');

    // Open Modal
    cvRequestButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            modalMessage.style.display = 'none'; 
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden'; 
        });
    });

    // Close Modal
    function closeModal() {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto'; 
        form.reset(); 
        submitBtn.classList.remove('loading'); 
        submitBtn.disabled = false;
    }

    closeButton.addEventListener('click', closeModal);
    window.addEventListener('click', function(event) {
        if (event.target === modal) {
            closeModal();
        }
    });

    // Handle Form Submission
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const emailInput = document.getElementById('request-email');
        if (!emailInput.value || !emailInput.value.includes('@')) {
            showMessage(modalMessage, 'error', 'Please enter a valid email address.', 3000);
            return;
        }
        
        const formData = new FormData(form);
        
        submitBtn.classList.add('loading');
        submitBtn.disabled = true;
        modalMessage.style.display = 'none';
        
        fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            body: formData,
        })
        .then(response => {
            if (response.ok) {
                return response.text();
            }
            throw new Error(`Server responded with status: ${response.status}`);
        })
        .then(text => {
            let data;
            try {
                data = JSON.parse(text);
                if (data.status === 'success') {
                    showMessage(modalMessage, 'success', 
                        "✅ Request Sent! A download link will be emailed to you upon approval from Weera."
                    );
                    fetchCvRequestCount(); 
                    setTimeout(closeModal, 3000); 
                } else {
                    showMessage(modalMessage, 'error', 
                        `❌ Submission Error: ${data.message || 'Unknown error occurred on the server.'}`
                    );
                }
            } catch (e) {
                showMessage(modalMessage, 'success', 
                    "✅ Request Submitted! Please wait for approval."
                );
                fetchCvRequestCount(); 
                setTimeout(closeModal, 3000);
            }
        })
        .catch(error => {
            console.error('Fetch error:', error);
            showMessage(modalMessage, 'error', 
                `❌ Connection Error: ${error.message}. Please check console (F12) or try again later.`
            );
        })
        .finally(() => {
            submitBtn.classList.remove('loading');
            submitBtn.disabled = false;
        });
    });
    
    // Helper function to show messages
    function showMessage(element, type, message, duration = 0) {
        element.textContent = message;
        element.className = `message-area ${type}`;
        element.style.display = 'block';
        if (duration > 0) {
            setTimeout(() => {
                element.style.display = 'none';
            }, duration);
        }
    }

    // Typewriter: 
    function typewriter(targetEl, text, options = {}) {
        const delay = options.speed || 40;
        const loop = options.loop || false; 
        const pauseAfter = options.pauseAfter || 1400;

        let i = 0;
        let deleting = false;

        function step() {
            if (!deleting) {
                if (i <= text.length) {
                    targetEl.textContent = text.slice(0, i);
                    i++;
                    setTimeout(step, delay);
                } else if (loop) {
                    setTimeout(() => { deleting = true; i = text.length; step(); }, pauseAfter);
                }
            } else {
                if (i >= 0) {
                    targetEl.textContent = text.slice(0, i);
                    i--;
                    setTimeout(step, Math.max(18, delay * 0.6));
                } else {
                    deleting = false;
                    i = 0;
                    setTimeout(step, 220);
                }
            }
        }

        step();
        return {
            stop() { deleting = false; i = text.length + 1; }
        };
    }
    
    // ข้อความ Typewriter ที่กระชับ
    const heroText = "Electrical Project Engineer | 7+ Years Experience | LV/MV Schneider Electric Systems | Full Project Lifecycle Management.";

    window.addEventListener('load', function() {
        fetchCvRequestCount();
        setupShareButtons();
        const target = document.getElementById('typewriter-target');
        if (target) {
            typewriter(target, heroText, { speed: 28, loop: false });
        }
    });

</script>

    </div> </body>
</html>